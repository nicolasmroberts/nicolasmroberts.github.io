


# These data come from Sarah Titus and Vasilis Chatzaras. They include field observations of orthopyroxene clasts and X-ray computed tomography of spinel clasts in rocks from the Massif du Sud, New Caledonia.



### DATA ###

# This is the northing-easting of the ridge-transform intersection.
ncRTI <- c(7.62656*10^6, 607488)

# This is a rough idea of the strike of the transform fault in degrees. More recently we think that it might be 000 degrees.
ncStrikeDeg <- 15

# SPO derived from field measurements of orthopyroxene by Sarah Titus.
# Each entry is (1) name, (2) northing-easting in meters, (3) OPX SPO ready for ellEllipsoidFromAxesDeg.
ncOrthoDeg <- list(
  list("KA04-20", c(7.639500693*10^6, 583398.61),
       c(1.087817206, 298.6557129, 1.187657461, 0.994413004, 207.4034339, 46.51074434, 0.924436918, 29.78159794, 43.46460596)),
  list("KA04-17", c(7.635358364*10^6, 591113.19),
       c(1.154435929, 116.0794408, 60.25990867, 1.04910731, 350.8843003, 18.22600983, 0.825677124, 252.9879004, 22.64649514)),
  list("KA04-23", c(7.63816651*10^6, 591336.11),
       c(1.112701314, 272.1602768, 24.05805765, 1.043665779, 36.1032262, 51.35585704, 0.861112623, 168.2905447, 28.23331822)),
  list("BG04-41", c(7.624503143*10^6, 601673.79),
       c(1.113736844, 341.8415518, 15.02557192, 0.981376027, 154.1000513, 74.8425554, 0.91491757, 251.3180657, 1.949414997)),
  list("BG04-04", c(7.626779317*10^6, 606293.81),
       c(1.126488363, 18.79145212, 2.30763474, 1.028775647, 110.1975296, 31.33827212, 0.862884395, 285.0124906, 58.5572689)),
  list("BG04-05", c(7.626900057*10^6, 606618.95),
       c(1.112192224, 195.083006, 1.105193311, 0.964896173, 102.2679248, 68.55489941, 0.931836165, 285.5164907, 21.41376292)),
  list("BG04-06", c(7.62655508*10^6, 607062.96),
       c(1.10787012, 199.6221642, 16.39194416, 0.996786701, 23.434461, 73.57366112, 0.905542662, 289.9262236, 1.03352482)),
  list("BG04-21", c(7.62670089*10^6, 607333.35),
       c(1.178337333, 194.9283247, 2.556983659, 0.993713033, 303.3585039, 81.95990676, 0.854022626, 104.5861235, 7.617556964)),
  list("BG04-20", c(7.626077681*10^6, 607831.78),
       c(1.182929679, 183.145755, 15.78015205, 0.989310622, 29.95462578, 72.43064932, 0.854492784, 275.2860049, 7.528113025)),
  list("BG04-07", c(7.624717957*10^6, 608383.97),
       c(1.219478337, 199.5416736, 18.72818254, 1.003645028, 21.64381586, 71.26008549, 0.817044616, 289.7584831, 0.639472168)),
  list("BG04-18", c(7.626424466*10^6, 608395.38),
       c(1.165501367, 177.3243732, 39.85827535, 1.02659222, 6.483822153, 49.77959196, 0.835774746, 271.113381, 4.525572337)),
  list("BG04-17", c(7.626203471*10^6, 608611.51),
       c(1.154435929, 183.2923802, 30.23331827, 1.04910731, 24.06563885, 58.06415792, 0.825677124, 278.7858192, 9.328319942)),
  list("BG04-08a", c(7.624749697*10^6, 608603.5),
       c(1.146841169, 194.5984415, 36.98975104, 1.042228302, 66.38588424, 39.39249035, 0.836630827, 309.2925701, 29.01323982)),
  list("BG04-09", c(7.625045704*10^6, 609032.03),
       c(1.184108979, 327.7598739, 49.29034907, 1.035361678, 161.1452148, 39.93119741, 0.815673286, 65.54586899, 6.648690149)),
  list("BG04-12", c(7.625927133*10^6, 609374.73),
       c(1.091837204, 342.9449187, 42.43855083, 1.053145307, 132.3888011, 43.2828126, 0.869668649, 237.8981112, 15.85047587)),
  list("BG04-10", c(7.625969486*10^6, 609659.97),
       c(1.17276704, 208.1849983, 1.7612529, 1.116294426, 321.0617425, 85.4774347, 0.763852478, 118.0567255, 4.164208153)),
  list("BG04-45", c(7.62293338*10^6, 610640.91),
       c(1.058640389, 353.2844876, 25.28132129, 1.004865255, 145.396597, 61.88187633, 0.940034323, 257.771523, 11.49774653)),
  list("BG04-39", c(7.618807269*10^6, 611553.52),
       c(1.045877498, 83.46078571, 56.04143277, 1.014988254, 263.2033275, 33.95829923, 0.942015751, 353.2836606, 0.119285746)),
  list("TH04-02", c(7.619925612*10^6, 616486.65),
       c(1.136707814, 261.1203538, 24.56617368, 1.028774052, 57.69107584, 63.51763335, 0.855128051, 166.8368562, 9.27985133)),
  list("RB04-01", c(7.549869818*10^6, 671636.1),
       c(1.140903744, 285.1387392, 2.624529225, 0.975316109, 15.49161884, 7.652406938, 0.898681077, 176.3379616, 81.9049293)),
  list("RB04-03", c(7.548549873*10^6, 699542.83),
       c(1.084592797, 256.6513618, 7.757362849, 1.018612085, 166.3346465, 2.323657028, 0.905158137, 59.77328832, 81.89798391)),
  list("RB04-04", c(7.547554683*10^6, 694133.28),
       c(1.063029284, 340.4607469, 10.63251377, 0.995210163, 248.3821779, 10.93483001, 0.945235381, 113.6284063, 74.65528317)),
  list("RB04-05", c(7.541512518*10^6, 667774.34),
       c(1.10634183, 257.0795336, 2.275085274, 1.008226433, 166.642721, 10.86275498, 0.896504735, 358.7581131, 78.89587012)))

# SPO derived from XRCT measurements by Vasilis Chatzaras.
# These SPO were re-calculated from the Avizo XRCT files by Joshua R. Davis on 2015/10/27.
# Each entry is (1) name, (2) northing-easting in meters, (3) spinel SPO ready for ellEllipsoidFromVector.
ncSpinel <- list(
  list("BG02-04", c(7.626773363*10^6, 606665.4412),
       c(-0.641009220918032, 0.120364182458668, 0.182704150819251, -0.614628410309956, -0.817752177369073)),
  list("BG02-05", c(7.626933798*10^6, 606676.8585),
       c(-0.967929771467355, 0.417370035936578, 0.0602413526397439, -1.07340135848784, -1.26327465816762)),
  list("BG02-07", c(7.62671551*10^6, 607324.8054),
       c(-1.08478731246575, 0.0102000873705439, -0.0152455299529606, -0.212618629317781, -0.506075290870927)),
  list("BG02-08", c(7.625974813*10^6, 607734.3863),
       c(-0.737977606462384, -0.0586943377647182, -0.290179702184897, -0.320952070321185, -0.393767693237433)),
  list("BG02-10", c(7.625969284*10^6, 609659.9663),
       c(0.0441328075417696, 0.061155918783615, -0.0873854813009937, 0.317437814495345, -0.165158015216261)),
  list("BG02-11", c(7.625917707*10^6, 609374.6609),
       c(0.256550884539786, 0.378336901305836, -0.0957534083950023, 0.141780406607239, -0.273662491726907)),
  list("BG02-12", c(7.625875257*10^6, 609103.2351),
       c(0.317632218465223, 0.380212872621898, -0.12846122329556, 0.19589310930897, -0.373851082027387)),
  list("BG02-13", c(7.62619392*10^6, 608630.4437),
       c(-0.0941405817427566, -0.0261117919133374, -0.0390546885392879, 0.198055603881846, -0.374102245970544)),
  list("BG02-15", c(7.626273657*10^6, 608294.2046),
       c(-0.59413306178874, -0.0180061936074537, -0.318272741492461, 0.244751894192931, -0.442648076807676)),
  list("BG02-16", c(7.626205984*10^6, 608205.6742),
       c(-0.117731572136237, 0.0596248312141299, -0.295561969129098, 0.140789737400309, -0.335794928909227)),
  list("BG04-02", c(7.627643661*10^6, 605815.52),
       c(-1.05896191544102, 0.15057615680474, 0.0381826272648983, -0.418528768494183, -0.147578325161983)),
  list("BG04-14", c(7.629254199*10^6, 603075.06),
       c(-0.02858937433454, -0.33325841253098, -0.167637241154568, 0.0370366314319417, -0.372699305789442)),
  list("BG04-40", c(7.619655643*10^6, 611063.9),
       c(0.146108748346092, -0.121445011062724, 0.347950205261878, -0.322463303758831, 0.248678382847676)),
  list("BG04-50", c(7.622453584*10^6, 610385.54),
       c(0.0749672573817825, 0.485002843169636, -0.273284737469521, 0.0189055656779289, -0.502894909553162)),
  list("BG04-53", c(7.620465168*10^6, 610316.74),
       c(0.751851174525836, -0.583279664785602, 0.360897218362023, -0.362879089373425, -0.113329295070732)),
  list("BG04-54", c(7.631348372*10^6, 598885.25),
       c(0.477252980154768, -0.0338836111936749, -0.059002827997987, 0.0234826994327672, -0.132202220808348)),
  list("KA04-21", c(7.638796638*10^6, 585057.57),
       c(0.0251414762670184, -0.324708685926427, -0.229716322376402, 0.162726045839435, 0.13509811130964)),
  list("KA04-24", c(7.634567861*10^6, 593871.58),
       c(0.119430679562205, 0.311721022471864, -0.220976830297277, -0.137103643604175, -0.151881571224264)),
  list("TH04-01", c(7.62043846*10^6, 615207.58),
       c(-0.0661026933641283, 0.147768129050133, 0.0925055180811896, -0.66269943867111, 0.205177069262728)),
  list("TH04-06", c(7.616652132*10^6, 619822.01),
       c(0.201609553240563, -0.137290628103431, -0.0294237699050382, 0.202067491808146, 0.322990803168536)))

# Stations with both OPX and spinel SPOs.
# The spinel SPO were re-calculated from the Avizo XRCT files by Joshua R. Davis on 2015/10/27.
# Each entry is (1) name, (2) northing-easting in meters, (3) OPX ellipsoid ready for ellEllipsoidFromAxesDeg, spinel ellipsoid ready for ellEllipsoidFromVector.
ncOrthoSpinelDeg <- list(
  list("KA04-06", c(7.644629765*10^6, 578442.27),
       c(1.058335032, 257.8912825, 12.31367077, 0.99560779, 353.2335261, 23.09959227, 0.949048795, 141.9541686, 63.47761514),
       c(-0.229847884443085, -0.294479136779701, -0.0816072209217505, -0.382351088300966, 0.190702240965156)),
  list("KA04-22", c(7.637845711*10^6, 586272.69),
       c(1.137177113, 333.6947627, 30.3460521, 0.966553622, 92.15811011, 39.14883841, 0.90980001, 218.4824114, 36.04055379),
       c(-0.0985402429015235, -0.250111645087982, -0.261803168985798, 0.0850376417586037, -0.00815411682568573)),
  list("KA04-18", c(7.636060028*10^6, 589670.8),
       c(1.122394819, 334.3618683, 7.52681553, 0.970981899, 86.51767451, 70.69176862, 0.917578466, 241.9489473, 17.67376015),
       c(0.121520268885226, -0.208775350572, 0.0981883613496538, -0.29318553722736, -0.32259568253326)),
  list("KA04-25", c(7.63152729*10^6, 595809.59),
       c(1.096867356, 315.1863731, 6.157881124, 0.975916946, 194.2766584, 78.13842394, 0.9341853, 46.2873835, 10.09832858),
       c(0.322833268504104, -0.0410200753109017, 0.219194985802441, -0.363313631048263, -0.123860898442175)),
  list("BG04-13", c(7.630187845*10^6, 602862.4642),
       c(1.05192371, 144.151096, 39.16999532, 0.99370768, 325.5331614, 50.82184124, 0.956658885, 234.7025583, 0.676841073),
       c(0.0998425863852175, -0.119522902136705, -0.27827735906159, 0.226479235167058, -0.626682576146218)),
  list("BG04-15", c(7.628766677*10^6, 604303.52),
       c(1.098162642, 219.9523623, 44.1028148, 1.014354101, 4.161445161, 39.92819774, 0.89772588, 110.7030073, 18.78676102),
       c(-0.340557447533194, -0.291282977585042, -0.455849854589812, 0.176524578127266, -0.34403138171196)),
  list("BG04-08.5", c(7.624845272*10^6, 608657.68),
       c(1.235162041, 183.5658219, 9.398718573, 0.971656822, 22.14905148, 80.09427514, 0.833226664, 274.0795301, 3.100419035),
       c(-0.218660451413418, 0.364985169586239, -0.10340975130536, 0.132972505102828, -0.436092627796643)),
  list("BG04-44", c(7.623656063*10^6, 609805.6),
       c(1.067213511, 22.24351221, 13.16479864, 1.00916986, 270.9986081, 57.15780731, 0.928505358, 119.843142, 29.48438233),
       c(0.384646273912458, 0.398113759276026, 0.170177895803584, -0.115853802915163, -0.619980698673457)),
  list("BG04-47", c(7.623342085*10^6, 611843.8),
       c(1.113945263, 125.4143128, 73.08939479, 1.03920505, 348.4212105, 12.53442767, 0.863843163, 255.9056863, 11.16738866),
       c(0.668333659630447, -0.226841597079508, 0.177592942987939, -0.176543099713581, -0.326800513183256)),
  list("BG04-38", c(7.619017432*10^6, 612376.68),
       c(1.026075122, 97.12492407, 69.12494062, 1.016962484, 324.417539, 14.50238148, 0.958331823, 230.5307836, 14.68465745),
       c(0.151656109653467, -0.312127176897651, 0.533977088300412, -0.0877655808275199, 0.197690058350678)),
  list("TH04-05", c(7.613121151*10^6, 624393.13),
       c(1.098641248, 312.5024992, 36.17821443, 1.029769505, 203.4705201, 24.03252756, 0.883901911, 87.79175164, 44.18001568),
       c(-0.214751869701918, 0.455136957320444, 0.19966900513284, -0.193175909583683, -0.084713221322814)))



### THREE REPACKAGINGS ###

# We produce three data lists: orthopyroxene data, spinel data, and paired orthopyroxene-spinel data. In each list, each element has the form
# $name: station name string
# $en: easting-northing relative to ridge-transform intersection, in km
# $ortho: orthopyroxene SPO (if available at this station)
# $spinel: spinel SPO (if available at this station)

# In this 'axesDeg' format, an ellipsoid is specified as nine numbers: a long semi-axis length, long axis trend in degrees, long axis plunge in degrees; then the same numbers for the intermediate and short axes.
ellEllipsoidFromAxesDeg <- function(axesDeg, doNormalize=FALSE) {
  # Organize the axes into a rotation.
  v1 <- geoCartesianFromTrendPlungeDeg(axesDeg[2:3])
  v2 <- geoCartesianFromTrendPlungeDeg(axesDeg[5:6])
  v3 <- geoCartesianFromTrendPlungeDeg(axesDeg[8:9])
  q <- rotProjectedMatrix(rbind(v1, v2, v3))
  if (det(q) < 0)
    q[3,] <- -q[3,]
  # Get the unnormalized semi-axis lengths.
  logA <- log(c(axesDeg[[1]], axesDeg[[4]], axesDeg[[7]]))
  ellEllipsoidFromRotationLogA(q, logA, doNormalize=doNormalize)
}

ncF <- function(station) {
  en <- c(station[[2]][[2]] - ncRTI[[2]], station[[2]][[1]] - ncRTI[[1]]) / 1000
  ortho <- ellEllipsoidFromAxesDeg(station[[3]], doNormalize=TRUE)
  spinel <- ellEllipsoidFromVector(station[[4]])
  list(name=station[[1]], en=en, ortho=ortho, spinel=spinel)
}
ncOrthoSpinels <- lapply(ncOrthoSpinelDeg, ncF)

ncF <- function(station) {
  en <- c(station[[2]][[2]] - ncRTI[[2]], station[[2]][[1]] - ncRTI[[1]]) / 1000
  ortho <- ellEllipsoidFromAxesDeg(station[[3]], doNormalize=TRUE)
  list(name=station[[1]], en=en, ortho=ortho)
}
ncOrthos <- lapply(c(ncOrthoSpinelDeg, ncOrthoDeg), ncF)

ncF <- function(station) {
  en <- c(station[[2]][[2]] - ncRTI[[2]], station[[2]][[1]] - ncRTI[[1]]) / 1000
  spinel <- ellEllipsoidFromVector(station[[length(station)]])
  list(name=station[[1]], en=en, spinel=spinel)
}
ncSpinels <- lapply(c(ncOrthoSpinelDeg, ncSpinel), ncF)


